2025-02-03 03:13:55.106 [kafka-coordinator-heartbeat-thread | my-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response. isDisconnected: false. Rediscovery will be attempted. - 
2025-02-03 03:13:55.147 [kafka-coordinator-heartbeat-thread | my-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null) - 
2025-02-03 03:13:55.150 [kafka-coordinator-heartbeat-thread | my-group] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-my-group-1, groupId=my-group] Client requested disconnect from node 2147483646 - 
2025-02-03 03:13:55.158 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null) - 
2025-02-03 03:13:55.161 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable. isDisconnected: false. Rediscovery will be attempted. - 
2025-02-03 03:13:55.163 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null) - 
2025-02-03 03:13:55.246 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null) - 
2025-02-03 03:16:19.930 [org.springframework.jms.JmsListenerEndpointContainer#0-1] WARN  o.s.j.l.DefaultMessageListenerContainer - Setup of JMS message listener invoker failed for destination 'repair-process-queue' - trying to recover. Cause: java.io.EOFException - 
2025-02-03 03:16:19.943 [org.springframework.jms.JmsListenerEndpointContainer#0-1] ERROR o.s.j.l.DefaultMessageListenerContainer - Could not refresh JMS Connection for destination 'repair-process-queue' - retrying using FixedBackOff{interval=5000, currentAttempts=0, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://activemq:61616. Reason: java.net.ConnectException: Connection refused - 
2025-02-03 03:16:28.086 [org.springframework.jms.JmsListenerEndpointContainer#0-1] ERROR o.s.j.l.DefaultMessageListenerContainer - Could not refresh JMS Connection for destination 'repair-process-queue' - retrying using FixedBackOff{interval=5000, currentAttempts=1, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://activemq:61616. Reason: java.net.ConnectException: Connection refused - 
2025-02-03 03:17:01.362 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  c.sto.repair.service.KafkaConsumer - Received message: {"id":9,"customer":{"id":1,"firstName":"Иван","lastName":"Петров","middleName":null,"phone":"+79123456792"},"vehicle":{"id":1,"make":"Toyota","model":"Camry","year":2020,"vin":"JTMZF33V70D123456","mileage":85000,"licensePlate":"А123ВЕ 77","engineType":"JTMZF33V70D123456"},"complaint":"Двигатель троит, повышенный расход топлива.","sentForRepair":false,"preferredDt":"2025-02-01","createdDt":"2025-02-03T03:16:54.586784","attachments":[{"id":9,"fileName":"engine_noise.mp4","fileType":"video/mp4","url":"https://sto.com/uploads/engine_noise.mp4"}],"notes":"Клиент просит перезвонить перед ремонтом"} - requestId=62166eac-938d-4082-9bd8-25edf5a83ea5
2025-02-03 03:17:01.379 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  c.s.r.service.impl.RepairServiceImpl - Analyzing issues of vehicle in bidId: 9 - requestId=62166eac-938d-4082-9bd8-25edf5a83ea5
2025-02-03 03:17:01.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  c.s.r.service.impl.RepairServiceImpl - Starting repair process for bidId: 9 - requestId=62166eac-938d-4082-9bd8-25edf5a83ea5
2025-02-03 03:17:01.418 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  c.sto.repair.util.WorkImitationUtil - BidId 9 starting repair - requestId=62166eac-938d-4082-9bd8-25edf5a83ea5
2025-02-03 03:17:01.447 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-my-group-1, groupId=my-group] Seeking to offset 7 for partition repair-bid-0 - 
2025-02-03 03:17:01.447 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - Record in retry and not yet recovered - 
2025-02-03 03:17:01.867 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  c.sto.repair.service.KafkaConsumer - Received message: {"id":9,"customer":{"id":1,"firstName":"Иван","lastName":"Петров","middleName":null,"phone":"+79123456792"},"vehicle":{"id":1,"make":"Toyota","model":"Camry","year":2020,"vin":"JTMZF33V70D123456","mileage":85000,"licensePlate":"А123ВЕ 77","engineType":"JTMZF33V70D123456"},"complaint":"Двигатель троит, повышенный расход топлива.","sentForRepair":false,"preferredDt":"2025-02-01","createdDt":"2025-02-03T03:16:54.586784","attachments":[{"id":9,"fileName":"engine_noise.mp4","fileType":"video/mp4","url":"https://sto.com/uploads/engine_noise.mp4"}],"notes":"Клиент просит перезвонить перед ремонтом"} - requestId=1071b313-30ae-42e3-a456-b0579fb9ebd2
2025-02-03 03:17:01.873 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] ERROR c.s.r.service.impl.RepairServiceImpl - BidId 9 already in repair - requestId=1071b313-30ae-42e3-a456-b0579fb9ebd2
2025-02-03 03:17:07.137 [http-nio-8091-exec-2] INFO  com.sto.repair.config.LoggingFilter - Request[uri: /repair-status/bids/9, content-type: null, method: GET, address: 172.30.0.1, query: null, body: ] - requestId=6173589c-7c3a-4aa6-9cae-69b7476a44fa
2025-02-03 03:17:07.159 [http-nio-8091-exec-2] INFO  com.sto.repair.config.LoggingFilter - Response[status: 200, body: {"status":"SUCCESS","message":null,"data":{"id":9,"customer":{"id":1,"firstName":"Иван","lastName":"Петров","middleName":null,"phone":"+79123456792"},"vehicle":{"id":1,"make":"Toyota","model":"Camry","year":2020,"vin":"JTMZF33V70D123456","mileage":85000,"licensePlate":"А123ВЕ 77","engineType":"JTMZF33V70D123456"},"complaint":"Двигатель троит, повышенный расход топлива.","status":"PROCESSING","preferredDt":"2025-02-01","estimatedRepairDt":"2025-02-03","createdDt":"2025-02-03T03:17:01.390501","repairReceivedDt":"2025-02-03T03:17:01.379228","repairFinishedDt":null,"attachments":[{"id":9,"fileName":"engine_noise.mp4","fileType":"video/mp4","url":"https://sto.com/uploads/engine_noise.mp4"}],"notes":"Клиент просит перезвонить перед ремонтом","issues":[{"code":"S001","description":"Обнаружен отказ двигателя","repairTimeInHours":0.001390},{"code":"T001","description":"Обнаружена проблема с передачей","repairTimeInHours":0.001390},{"code":"G001","description":"Неисправность тормозной системы","repairTimeInHours":0.001390}]}}] - requestId=6173589c-7c3a-4aa6-9cae-69b7476a44fa
2025-02-03 03:17:12.078 [http-nio-8091-exec-3] INFO  com.sto.repair.config.LoggingFilter - Request[uri: /repair-status/bids/9, content-type: null, method: GET, address: 172.30.0.1, query: null, body: ] - requestId=cda82f85-b904-46ba-b49d-42ec1c325992
2025-02-03 03:17:12.094 [http-nio-8091-exec-3] INFO  com.sto.repair.config.LoggingFilter - Response[status: 200, body: {"status":"SUCCESS","message":null,"data":{"id":9,"customer":{"id":1,"firstName":"Иван","lastName":"Петров","middleName":null,"phone":"+79123456792"},"vehicle":{"id":1,"make":"Toyota","model":"Camry","year":2020,"vin":"JTMZF33V70D123456","mileage":85000,"licensePlate":"А123ВЕ 77","engineType":"JTMZF33V70D123456"},"complaint":"Двигатель троит, повышенный расход топлива.","status":"PROCESSING","preferredDt":"2025-02-01","estimatedRepairDt":"2025-02-03","createdDt":"2025-02-03T03:17:01.390501","repairReceivedDt":"2025-02-03T03:17:01.379228","repairFinishedDt":null,"attachments":[{"id":9,"fileName":"engine_noise.mp4","fileType":"video/mp4","url":"https://sto.com/uploads/engine_noise.mp4"}],"notes":"Клиент просит перезвонить перед ремонтом","issues":[{"code":"S001","description":"Обнаружен отказ двигателя","repairTimeInHours":0.001390},{"code":"T001","description":"Обнаружена проблема с передачей","repairTimeInHours":0.001390},{"code":"G001","description":"Неисправность тормозной системы","repairTimeInHours":0.001390}]}}] - requestId=cda82f85-b904-46ba-b49d-42ec1c325992
2025-02-03 03:17:58.308 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Request joining group due to: group is already rebalancing - 
2025-02-03 03:17:58.311 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-my-group-1, groupId=my-group] Revoke previously assigned partitions repair-bid-0 - 
2025-02-03 03:17:58.312 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - my-group: partitions revoked: [repair-bid-0] - 
2025-02-03 03:17:58.313 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] (Re-)joining group - 
2025-02-03 03:17:58.317 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Successfully joined group with generation Generation{generationId=20, memberId='consumer-my-group-1-934e893d-ad3f-4d9f-a11d-d1ab212e89e6', protocol='range'} - 
2025-02-03 03:17:58.330 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Finished assignment for group at generation 20: {consumer-my-group-1-934e893d-ad3f-4d9f-a11d-d1ab212e89e6=Assignment(partitions=[repair-bid-0])} - 
2025-02-03 03:17:58.334 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Successfully synced group in generation Generation{generationId=20, memberId='consumer-my-group-1-934e893d-ad3f-4d9f-a11d-d1ab212e89e6', protocol='range'} - 
2025-02-03 03:17:58.335 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Notifying assignor about the new Assignment(partitions=[repair-bid-0]) - 
2025-02-03 03:17:58.335 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-my-group-1, groupId=my-group] Adding newly assigned partitions: repair-bid-0 - 
2025-02-03 03:17:58.339 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition repair-bid-0 to the committed offset FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}} - 
2025-02-03 03:17:58.339 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - my-group: partitions assigned: [repair-bid-0] - 
2025-02-03 03:17:59.225 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-my-group-1, groupId=my-group] Revoke previously assigned partitions repair-bid-0 - 
2025-02-03 03:17:59.226 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - my-group: partitions revoked: [repair-bid-0] - 
2025-02-03 03:17:59.227 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Member consumer-my-group-1-934e893d-ad3f-4d9f-a11d-d1ab212e89e6 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics - 
2025-02-03 03:17:59.228 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Resetting generation and member id due to: consumer pro-actively leaving the group - 
2025-02-03 03:17:59.229 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Request joining group due to: consumer pro-actively leaving the group - 
2025-02-03 03:17:59.229 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-my-group-1, groupId=my-group] Unsubscribed all topics or patterns and assigned partitions - 
2025-02-03 03:17:59.234 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Resetting generation and member id due to: consumer pro-actively leaving the group - 
2025-02-03 03:17:59.235 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-my-group-1, groupId=my-group] Request joining group due to: consumer pro-actively leaving the group - 
2025-02-03 03:17:59.562 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed - 
2025-02-03 03:17:59.563 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter - 
2025-02-03 03:17:59.564 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter - 
2025-02-03 03:17:59.564 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed - 
2025-02-03 03:17:59.573 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-my-group-1 unregistered - 
2025-02-03 03:17:59.574 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - my-group: Consumer stopped - 
2025-02-03 03:17:59.579 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete - 
2025-02-03 03:17:59.583 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete - 
2025-02-03 03:17:59.592 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default' - 
2025-02-03 03:17:59.597 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated... - 
2025-02-03 03:17:59.601 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed. - 
